module Day3 where

-- Constants
origin :: (Int, Int)
origin = (0, 0)

treeChar :: Char
treeChar = '#'

-- Version2 (using modulo and )
elementsOnWay :: [[Char]] -> (Int, Int) ->  [Char]
elementsOnWay field slope = map fieldElem pathPoints
    where 
        fieldWidth = length $ head field
        applySlope (right, low) (col, line) = ((col + right) `mod` fieldWidth,  low + line )
        pointsOnSlope = iterate (applySlope slope) origin
        pointIsOnField (_, l) = l < length field
        pathPoints = takeWhile pointIsOnField pointsOnSlope -- Get all points until line is outside the field
        fieldElem (col, line) = (field !! line) !! col

-- Count the number of trees in the path
treesOnPath :: [Char] -> Int
treesOnPath = length . filter ( == treeChar) 

answerQ1 :: Int
answerQ1 = treesOnPath $ elementsOnWay demoInput (3, 1) 

-- Exercice 2, choose between multiple slopes.
slopes :: [(Int, Int)]
slopes = [(1,1), (3, 1), (5, 1), (7, 1), (1, 2)]

slopesTreesOnPathV2 :: [Int]
slopesTreesOnPathV2 = map (treesOnPath . elementsOnWay input) slopes

answerQ2 :: Int
answerQ2 = product slopesTreesOnPathV2

-- result [68,203,78,77,40] -> 3316272960

-- Donn√©es
demoInput :: [[Char]]
demoInput = [
    "..##.......",
    "#...#...#..",
    ".#....#..#.",
    "..#.#...#.#",
    ".#...##..#.",
    "..#.##.....",
    ".#.#.#....#",
    ".#........#",
    "#.##...#...",
    "#...##....#",
    ".#..#...#.#"
    ]

input :: [[Char]]
input = [
    ".....##.#.....#........#....##.",
    "....#...#...#.#.......#........",
    ".....##.#......#.......#.......",
    "...##.........#...#............",
    "........#...#.......#.........#",
    "..........#......#..#....#....#",
    "..................#..#..#....##",
    ".....##...#..#..#..#..#.##.....",
    "..##.###....#.#.........#......",
    "#.......#......#......#....##..",
    ".....#..#.#.......#......#.....",
    "............#............#.....",
    "...#.#........#........#.#.##.#",
    ".#..#...#.....#....##..........",
    "##..........#...#...#..........",
    "...........#...###...#.......##",
    ".#..#............#........#....",
    "##.#..#.....#.......#.#.#......",
    ".##.....#....#.#.......#.##....",
    "..##...........#.......#..##.#.",
    "##...#.#........#..#...#...#..#",
    ".#..#........#.#.......#..#...#",
    ".##.##.##...#.#............##..",
    "..#.#..###......#..#......#....",
    ".#..#..#.##.#.##.#.#...........",
    "...#....#..#.#.#.........#..#..",
    "......#.#....##.##......#......",
    "#....#.##.##....#..#...........",
    "...#.#.#.#..#.#..#.#..#.##.....",
    "#.....#######.###.##.#.#.#.....",
    "..#.##.....##......#...#.......",
    "..#....#..#...##.#..#..#..#..#.",
    ".............#.##....#.........",
    ".#....#.##.....#...............",
    ".#............#....#...#.##....",
    ".#.....#.##.###.......#..#.....",
    ".#...#.........#.......#..#....",
    "..#.#..#.##.......##...........",
    ".....##..#..#..#..#.##..#.....#",
    "..##............##...#..#......",
    "...#..#....#..##.....##..#.#...",
    "#.....##....#.#.#...#...#..##.#",
    "#.#..#.........#.##.#...#.#.#..",
    ".....#.#....##....#............",
    "#.......#..#.....##..#...#...#.",
    ".....#.#...#...#..#......#.....",
    "..##....#.#.#.#.#..#...........",
    "##..#...#.........#......#...#.",
    "..#...#.#.#.#..#.#.##..##......",
    "#............###.....###.......",
    "..........#...#........###.....",
    ".......##...#...#...#........#.",
    ".#..#.##.#.....................",
    ".#..##........##.##...#.......#",
    ".......##......#.....#......#..",
    ".##.#.....#......#......#......",
    "#...##.#.#...#.#...............",
    "........#..#...#.##.......#....",
    "...................#...#...##..",
    "...#...#.........#.....#..#.#..",
    ".###..#........#..##.##..#.##..",
    "#...#.....#.....#.....#..#..#..",
    "###..#.....#.#.#.#......#....#.",
    "#........#....##.#...##........",
    ".#.#..##........##....##.#.#...",
    "#...#....#.###.#.#.........#...",
    "...#...##..###.......#.........",
    "......#....#..##..#.....#.#....",
    "........#...##...###......##...",
    "..........##.#.......##........",
    "...#....#......#...##.....#....",
    "###.#.....#.#..#..#....#...#..#",
    ".#.....#.#....#...............#",
    "..#....#....####....###....#.#.",
    "....##........#..#.##.#....#...",
    ".......##...#...#..#....####...",
    "#...##.#......##...#..#........",
    "..##..#.##....#.......##.#.#...",
    "..#.#...............#...#.#....",
    "....#.....#.#.....#.##.......#.",
    "...#.#..##.#.#..............##.",
    "..#.....#...#.............#.##.",
    "##..#.#...#........#..#.....##.",
    "...........##...#.#.###...#....",
    "...#.#.#..#..................#.",
    ".#...##.............#...#......",
    "..#..#...#.#.......#...#.....#.",
    "..##.......#.#.................",
    ".##..#........###.....#....#.##",
    "......#..###.......#....##....#",
    "....#.....#.................#..",
    "........#...#...#..............",
    "...#..#.###.......#..#.#.#.##..",
    "..#...#.....#....#.........#...",
    "...#.............#........###..",
    "......#..............#......#..",
    "#..#...........#...#..........#",
    "...##...#.###..#...#.....#.#...",
    "....#..##......#.......##......",
    "....#....##.#...#.#..#....#...#",
    ".#...........#..#....##...#..##",
    "..#.#.................###.#...#",
    "..#.#.#...##...........#.......",
    "..........#..##...#.#..##....##",
    "........#........#.##..#.#...#.",
    ".....#...##.......##......#...#",
    "....#...#..#..#.....#..........",
    ".#..#......#..#..#..###.......#",
    ".##..........#...#...#.#.....##",
    "..#..........#.#.#...###.......",
    "....#................#...##....",
    ".##..#....#..........#.#.#.....",
    "..##...#.#........#.....#.##...",
    "....####.....#..#.........##..#",
    "......#.........#...#..........",
    "....#...................#..##..",
    ".##....#.#.........#....#...#..",
    "....##...##.....#..####........",
    "..##.#....#.#.......##...#.....",
    "#...#.#.#...#..#..##.....#.....",
    "#..................###.....#...",
    "#.#.....#.......#.#...###.#....",
    ".#..#....#............#........",
    "#.#....#..#.#...............#..",
    "..#..#..#.............#......#.",
    "..#.......##...................",
    ".#....#.........#....#.#.#..#..",
    "....#....#..#...............#..",
    "......#..#..##......#.........#",
    "..#.##........##......#..#..#.#",
    "#.....#.#....#.........##...#..",
    "###..............#....###...##.",
    "....#..##......#.......##......",
    "......#...#.##......##....#..#.",
    "..........#....#..##.......#..#",
    ".#..#...##..#...........#..#..#",
    ".....#....#...#..###...###....#",
    ".#####..#...#.#.#..#.#.###...##",
    "..##............##.#...#.##...#",
    ".##..#...#...#....##.#..#..##..",
    ".#....#...#............##..#...",
    ".#.#......#....#....#..##..##..",
    ".........#...#.......#.##..#...",
    "#.........#.....##.....#..#..#.",
    "...##.#...#...#..#..#....##..##",
    ".#............#...#....##......",
    "..#...#.##.........#.#......#.#",
    "....#.##........#.........#..##",
    "#.........#......#.#......#..#.",
    "........#.#.......#.#........#.",
    "..#..........##.#...#..#.#.....",
    "..#...#....#...#...#..#.#..#.#.",
    ".#.........#....#..#####..#....",
    "#.#....#.#.###...#.............",
    "..##...........##......##......",
    "#.....#..#....#...............#",
    "...#.#..#....##......#...##....",
    "...#........#.....#...#..#.....",
    ".#......##.........#......#....",
    "..#..###.##...#.#.....#........",
    ".............#......#..#.......",
    "..#...............#.#...#..#..#",
    ".......#..#...#.#####......#..#",
    ".........#.....#...............",
    "##........#............#.#.....",
    ".#...#.....#..#..#...#....#...#",
    "..#....#....##......##.....#.#.",
    "#...##..##......#...#....#.....",
    "....#.#.#.....###....##.##....#",
    "..........##...##.......#......",
    "..#.......#...##.#....##.##....",
    "....#........................#.",
    "...#...#.#.##...#.....#...#..#.",
    ".#....##..#..#..........##..##.",
    ".#.....#..#...#.##.....#.......",
    ".#.##...#.#..#.....##....#...#.",
    ".##...#........##....#..#......",
    ".....#........#..........#.#..#",
    "....#..##.......#..#.....#.....",
    "...........#...#........#.##..#",
    ".....#..#....#..#.#.....#....##",
    ".....#....#.##.#..##...........",
    "...##.......##.........#.......",
    "...............##..#....#.#....",
    ".......###..#........#..####.##",
    ".......#.##...#.#....#.####....",
    "....#...............#..........",
    "##.#.......#.....#......#...#..",
    "......##.....#....#.....#..#..#",
    ".....#...##.............#......",
    "#.#.##.#.....#..#........#.....",
    "......##....#..#........#......",
    "............#........#..#.#....",
    "##.......#......#...####..#.##.",
    "..##..#...#.............#.##...",
    ".....#..##......#.##......###..",
    "............#........#........#",
    "#.#.#.#...#.#.....#.........#..",
    ".........#...............#.....",
    ".............###.#.......#....#",
    "###.##..#..#..........#....#...",
    "#......#...#..#..#.....#.##....",
    "............#....#....#..#.....",
    "..#.#....#...#......#.#..#..##.",
    "...#........................#..",
    "#.#...#..........#......#.#....",
    ".........#................#...#",
    "##.....#....#........##.......#",
    "#...##........#...#...........#",
    "...#...#..........##.......#.#.",
    "..#.#.#....#......##...........",
    "...#.#...#.##.#..#.#.##........",
    "#....##.....###..#.......#.....",
    "###.....#.#.#...#..#.........##",
    "..#......#..###...#.#.#.....#.#",
    ".#....#.....#............#..##.",
    "....#....##..........#.....##..",
    "#...........#....#...#..#...##.",
    "..#.......#.....#..........#...",
    ".#..#................#......#..",
    "..#......#.#...#..#.#....#....#",
    "...#..#...###..#..##....#.#....",
    "..#..............#.....#.......",
    "...#.#...#.........#.#.........",
    "##......##...........##.#.##..#",
    "..#..##..#....#.#......#.#...##",
    "...#.###....###...#.....#......",
    "#.#................#......#....",
    "..#.....#.....#....##.......#..",
    ".#.#...............##..#.......",
    "...#....#.......#.#.....##..#..",
    ".........#....#.......#.#...##.",
    "#....#......##.#.........##...#",
    "#.............#..##.#.#..##....",
    "...#....#..#...#....#.#.#.#...#",
    ".#....#....#..##.....#.#...###.",
    "##............#.#...##.#..#.#..",
    "##.#....##.....#..#..###....#..",
    "##....#................##......",
    "...##..#...#..###....#.....##..",
    ".#...##......#..#.#.....#...#..",
    "..##......##...#.##.......#....",
    "......#.....#.....##........#.#",
    "##....#...........#............",
    "#.......#....#..#.##..##.#..#..",
    ".#....##.#.....#..#..#.........",
    ".#....#.#.#...#.....##.....#.#.",
    ".......##.#.#........#......##.",
    "##........#.##.......#...#..#..",
    "...###..##....#.#....#.#.......",
    "......#.......#...##.....#...#.",
    "..#......##.#......#.....#.....",
    ".....#.....###...#.............",
    "#...#.#...#...#..#......#......",
    "#.....#.......###.#....###.#...",
    "...#.......#....####....##..#..",
    "#.#.....#....#........#.......#",
    ".........#.......#......#.#...#",
    "..##....#.....##...............",
    "..........#..#.#..#......#.....",
    "..................##...##.#....",
    "........#.......#...#..#.#.#...",
    ".....#.#..##..#..#.#..#.......#",
    ".....#........#..#..#....#....#",
    "##............#..#..#...#....#.",
    ".....#....................##..#",
    "........##.#....###............",
    "##.......#.##................#.",
    ".....###.#..#..#...#....###.##.",
    ".#......#.#....#.....##.#......",
    "...##......##.........#...#....",
    "....####..............#........",
    "#...#.#..##..##.........##.....",
    "......#......#....#..#.........",
    "#.....#.....#.##...............",
    "..#.##..#...##.#.####..#....###",
    "#..#......#....#.##..##...#.#..",
    "#....#.......#.....#.....#.#...",
    "##.......#.....##...#.....#....",
    "...#...##..........#..##..##..#",
    ".###..#..##...#....#...#..#....",
    "......##..###.......###...#....",
    "....#...#.#.......#.##...##..##",
    "#.#......#..##.#.#..#..#..#....",
    "......#........#.......#.......",
    "..........#.#.....##...........",
    "......#..#........#..#.#..###..",
    "##..#.............##..#........",
    ".........#....#.....#.........#",
    ".....#..##...#..#..##.##......#",
    "###..#...........#.......#....#",
    "...............#....#.#........",
    ".##.#...#.#........##....#.....",
    ".##.###...##..###....#...#...#.",
    ".##..#....#.#.#...#.#.#.#...#..",
    ".###.#...#.......#....#..#.....",
    "..#..#.#.#.#........#.....##...",
    ".#.......#.#...#.#...........##",
    "...#.....##....#.....##...#....",
    "................#.....####...#.",
    ".#.#......#.......##...#.##....",
    ".###.........#.#......#..#.#...",
    "#......#...#....#..##.......#..",
    ".##..#....#..#...........#...#.",
    ".#...#.......##........#.##....",
    "..#...........#...##...........",
    ".....##....##......#....#..#...",
    "#......#.#...#.##.#...##....#..",
    "#....................#...##...#",
    "..#............#........#......",
    ".............#.........##.....#",
    "...#...#......##.#...#...#.#...",
    "..#...#.#.................#....",
    "....##...#....#...###.##......#",
    "...#....#...#..#...#....#.....#",
    "...##.#........#..#.........#..",
    "..##.....#..##...#.....##...#..",
    "#.........#.#.#...#......#...#.",
    "#.#...........#...#..#..#..##..",
    "..#..#..##....#..........#.###.",
    ".....#..#....#.#...#...#..#..#.",
    "###.....#..#.................#.",
    ".#..##.##.#......#....##..#...."
    ]